<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>The Sentinel - Security Brief Email</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Serif:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet"/>
<style>
    /* RESET STYLES */
    body {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        margin: 0;
        padding: 0;
        width: 100% !important;
        min-width: 100%; 
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        color: #333333;
    }
    table {
        border-spacing: 0;
        border-collapse: collapse;
    }
    a { text-decoration: none; color: #0052cc; }
    
    @media only screen and (max-width: 600px) {
        .content-wrapper {
            padding-left: 16px !important;
            padding-right: 16px !important;
            width: 100% !important; 
        }
        .desktop-thumbnail {
            display: none !important;
        }
        .mobile-thumbnail {
            display: block !important;
            width: 100% !important;
            height: auto !important;
            margin-bottom: 16px !important;
        }
        .header-flex {
            flex-direction: column !important;
            align-items: flex-start !important;
            gap: 4px !important;
        }
        .header-flex > div {
            text-align: left !important;
            width: 100% !important;
        }
    }

    @media screen and (max-width: 600px) and (-webkit-min-device-pixel-ratio: 2) {
    /* Styles for High-Res Mobile (Mostly Android & iPhone) */
    .content-wrapper {
        padding-left: 6px !important;
        padding-right: 6px !important;
        width: 100% !important; 
    }
}
</style>
</head>
<body style="font-family: 'Inter', sans-serif; margin: 0; padding: 0; background-color: #ffffff;" class="body">

<table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#ffffff">
    <tr>
        <td align="center" style="padding: 20px 0;">
            
            <div class="content-wrapper" style="max-width: 600px; margin: 0 auto; width: 100%; background-color: #ffffff; text-align: left;">
            
                <!-- Header -->
                <div style="padding-bottom: 24px; border-bottom: 1px solid #eeeeee; margin-bottom: 24px;">
                    <div class="header-flex" style="display: flex; flex-wrap: wrap; align-items: flex-end; justify-content: space-between; gap: 16px;">
                        <div>
                            <h1 style="font-size: 24px; font-weight: 700; letter-spacing: -0.025em; color: #000000; margin: 0;">RSS Intelligence</h1>
                            <p style="font-size: 12px; font-weight: 600; color: #666666; margin: 4px 0 0 0; letter-spacing: 0.05em; text-transform: uppercase;">The Sentinel Digest</p>
                        </div>
                        <div style="text-align: right;">
                            <p style="font-size: 14px; color: #666666; margin: 0;">{{ date }}</p>
                        </div>
                    </div>
                </div>

                <!-- Executive Summary -->
                {% if is_summary and not fallback and payload.get("exec_summary") %}
                <div style="margin-bottom: 32px;">
                    <h3 style="font-size: 14px; font-weight: 700; color: #000000; text-transform: uppercase; margin: 0 0 12px 0; letter-spacing: 0.05em;">Executive Summary</h3>
                    <div style="font-family: 'Noto Serif', Georgia, serif; font-size: 16px; line-height: 1.6; color: #333333;">
                        {{ payload.get("exec_summary") | markdown }}
                    </div>
                </div>
                <hr style="border: 0; border-bottom: 1px solid #eeeeee; margin: 0 0 32px 0;" />
                {% endif %}

                {% if fallback %}
                    <pre style="background-color: #f5f5f5; padding: 16px; border-radius: 4px; overflow-x: auto; font-size: 13px; font-family: monospace; color: #333333;">{{ fallback }}</pre>
                {% else %}
                    <!-- Articles -->
                    {% set articles = payload.get("summaries", []) if is_summary else payload %}
                    
                    {% for item in articles %}
                        {% set article = item.get("summary", item) if is_summary else item %}
                        {% set image = item.get("image") or article.get("image") %}
                        
                        <div style="margin-bottom: 40px;">
                            <!-- Category Tag -->
                            {% if is_summary %}
                            <div style="margin-bottom: 8px;">
                                <span style="font-size: 11px; font-weight: 700; color: #0052cc; text-transform: uppercase; letter-spacing: 0.05em;">
                                    {{ item.get("category", "General") }}
                                </span>
                            </div>
                            {% endif %}

                            <!-- Title -->
                            <h2 style="font-size: 20px; font-weight: 700; color: #000000; line-height: 1.3; margin: 0 0 12px 0;">
                                {% if article.get("url") %}
                                <a href="{{ article.get('url') }}" style="color: #000000; text-decoration: none;">{{ article.get("title") or article.get("url") }}</a>
                                {% else %}
                                {{ article.get("title") or article.get("url") }}
                                {% endif %}
                            </h2>

                            <!-- Why It Matters -->
                            {% if is_summary and article.get("rank-reasoning") %}
                            <p style="font-size: 16px; color: #555555; margin: 0 0 16px 0; line-height: 1.5; font-style: italic;">
                                <strong>Why it matters:</strong> {{ article.get("rank-reasoning") }}
                            </p>
                            {% endif %}

                            <!-- Image (Mobile/Desktop Unified for Simplicity) -->
                            {% if image %}
                            <div style="margin-bottom: 16px;">
                                <img src="{{ image }}" alt="Article Image" style="width: 100%; max-width: 100%; height: auto; border-radius: 4px; display: block;" />
                            </div>
                            {% endif %}

                            <!-- Content -->
                            <div style="font-size: 16px; line-height: 1.6; color: #333333; margin-bottom: 16px;">
                                {% if is_summary %}
                                    {{ article.get("what") | nl2br }}
                                {% else %}
                                    {{ (article.get("summary") or article.get("text")) | nl2br }}
                                {% endif %}
                            </div>

                            <!-- Impact & Action (Simple Indented Block) -->
                            {% if is_summary %}
                            <div style="border-left: 2px solid #0052cc; padding-left: 6px; padding-right: 10px; margin-bottom: 16px;">
                                <div style="margin-bottom: 12px;">
                                    <strong style="font-size: 12px; color: #666666; text-transform: uppercase; letter-spacing: 0.05em; display: block; margin-bottom: 4px;">Impact</strong>
                                    <div style="font-size: 15px; color: #333333; line-height: 1.5;">{{ article.get("so-what") | nl2br }}</div>
                                </div>
                                <div>
                                    <strong style="font-size: 12px; color: #666666; text-transform: uppercase; letter-spacing: 0.05em; display: block; margin-bottom: 4px;">Action Item</strong>
                                    <div style="font-size: 15px; color: #0052cc; font-weight: 500; line-height: 1.5;">{{ article.get("now-what") | nl2br }}</div>
                                </div>
                            </div>
                            {% endif %}

                            <!-- Read More Link -->
                            {% if article.get("url") %}
                            <div style="margin-top: 12px;">
                                <a href="{{ article.get('url') }}" style="font-size: 14px; font-weight: 600; color: #0052cc; text-decoration: none;">
                                    Read Source &#8594;
                                </a>
                            </div>
                            {% endif %}
                            
                            <!-- Separator between articles -->
                            {% if not loop.last %}
                            <hr style="border: 0; border-bottom: 1px solid #eeeeee; margin: 40px 0;" />
                            {% endif %}
                        </div>
                    {% endfor %}
                {% endif %}

                <!-- Footer -->
                <div style="border-top: 1px solid #eeeeee; padding-top: 24px; text-align: center; margin-top: 40px;">
                     <p style="font-size: 12px; color: #888888; margin: 0 0 8px 0;">Daily RSS Digest | Internal Use Only</p>
                     <p style="font-size: 12px; color: #aaaaaa; margin: 0;">&copy; 2025 Coupang Security Team</p>
                </div>

            </div>
        </td>
    </tr>
</table>

</body>
</html>
